<!DOCTYPE html>
<html>
<head>
    <title>Image Viewer</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script>
        //imgs is the array of images, which would be filled in websocket methods
        //we should be storing the target data separately, since an image can have multiple targets
        var imgs = new Array();
        imgs[0]=new Image();
        imgs[0].src="./images/img1.png";
        imgs[1]=new Image();
        imgs[1].src="./images/img2.png";
        imgs[2]=new Image();
        imgs[2].src="./images/img3.png";
        imgs[3]=new Image();
        imgs[3].src="./images/img4.png";
        imgs[4]=new Image();
        imgs[4].src="./images/img5.png";

        //when a new image is sent, add it to the array and have the following code to append it to the grid
        //current grid assumes that all images are the same size, which won't be the case if we crop them before sending them
        //if the images are different sizes, the grid would stay aligned but have lots of white space
        window.onload = function displaying(){
            //making the grid and viewer panels the height of the window
            //if the window height changes, the page has to be reloaded
            //when the window cannot fit the grid vertically, we can scroll through them
            var height = window.innerHeight;
            document.getElementById("left-panel").style.maxHeight=height+'px';
            document.getElementById("right-panel").style.maxHeight=height+'px';
            //calculating the number of columns in the grid based on the sizes of panels and thumbnails
            var width = document.getElementById("left-panel").clientWidth;
            var imgwidth = 200;
            var colwidth=imgwidth+2*5//image width + padding on both sides
            var numcols=Math.trunc(width/colwidth);
            if (numcols==0) numcols++;
            console.log(width+" "+imgwidth+" "+numcols);
            var grid = document.getElementById('imagegrid');
            for(c=0; c<imgs.length; c++) {
                if (c%numcols==0) {
                    grid.appendChild(document.createElement("tr"));//adding a row
                }
                //finding the last row in the grid
                var rows = document.getElementsByTagName("tr");
                var row = rows[rows.length-1];
                //adding a column and the thumbnail
                var col = document.createElement("td");
                var img = document.createElement("img");
                img.src=imgs[c].src;
                img.width=imgwidth;//scale the images so that they all have the same width
                //selecting the image shown in the viewer
                img.addEventListener("click", function() {
                    document.focusedImage.src=this.src;
                    return false;
                });
                col.appendChild(img);
                row.appendChild(col);
            }
        }
    </script>
</head>

<body>
    <div id="left-panel">
        <table id="imagegrid">
        </table>
    </div>
    <div id="right-panel">
        <img src="./images/img1.png" name="focusedImage" alt="">
        <p>This is where image and target data could be displayed</p>
    </div>

</body>
</html>